---
title: "Trabalho MLG"
subtitle: ""
author: "Eliana Cardoso Gon√ßalves"
date: "05/25/2024"
date-format: short # formatacao dd/mm/aaaa
lang: pt #linguagem
toc: true # indice
number-sections: true
fig-cap-location: top #localizacao titulo figura 
geometry:
      - top=3cm
      - left=3cm
      - right=2cm
      - bottom=2cm
tbl-cap-location: top
df-print: kable ## saida dos data frames serem kable
fig-width: 10
fig-height: 4
format: 
  html:
    self-contained: true # tornar o html compartilhavel
    theme: flatly
  pdf: 
    documentclass: scrreprt
  docx: default
editor: source
editor_options:
  chunk_output_type: console
output: 
  pdf_document:
    margin: 1in
    df_print:
      digits: 3
  word_document:
      fig_caption: true
      df_print: kable
prefer-html: true
execute:
  echo: false
  warning: false
---
```{r}
rm(list = ls())
```

```{r,biblioteca}

library(corrplot)
# bases de dados diversas
library(haven)
# gr√°ficos diversos
library(ggplot2)
# manipula√ß√£o de bases de dados
library(tidyverse)
# an√°lise de regress√£o
library(performance)
library(see)
library(car)
library(knitr)
library(kableExtra)
library(patchwork)
library(reglin)
library(summarytools)
```


```{r,diretorio}

setwd("C:/Users/cardo/OneDrive/Documents/Estat√≠stica/7 per√≠odo/mlg/M√≥dulo 1. Modelos Lineares Normal, Poisson e Log√≠stico-20240525/code")
source("_src/src.R")

```

```{r}
dta = read_dta("_dta/pwt1001.dta")
# filtrando para 2014
dta = dta %>% subset(year == '2014')
```




## Introdu√ß√£o

A an√°lise macroecon√¥mica √© fundamental para entender o desenvolvimento econ√¥mico e social dos pa√≠ses. No contexto da contabilidade nacional, vari√°veis como o Produto Interno Bruto (PIB), a for√ßa de trabalho e o estoque de capital s√£o essenciais para avaliar a produtividade e o crescimento econ√¥mico. Este estudo utiliza dados da Penn World Table de 2020 para investigar a rela√ß√£o entre essas vari√°veis.

O PIB nacional \(Y\), medido em d√≥lares PPC de 2014, √© uma medida abrangente da atividade econ√¥mica de um pa√≠s. A for√ßa de trabalho \(L\) representa o total de pessoas empregadas ou em busca de emprego, refletindo a capacidade produtiva humana. O estoque de capital \(K\), tamb√©m medido em d√≥lares PPC de 2014, indica o valor total dos ativos produtivos de um pa√≠s, como m√°quinas, edif√≠cios e infraestrutura.



Ao analisar essas vari√°veis, o objetivo √© fornecer insights sobre as pol√≠ticas econ√¥micas que podem fomentar o crescimento e a produtividade. Esta investiga√ß√£o pode ajudar formuladores de pol√≠ticas, economistas e pesquisadores a identificar √°reas-chave para interven√ß√£o e investimento, promovendo um desenvolvimento econ√¥mico sustent√°vel e inclusivo.

## Metodologia

Este estudo se concentra em uma amostra de 144 pa√≠ses distintos no ano de 2014, utilizando um modelo linear normal para explorar como a for√ßa de trabalho e o estoque de capital influenciam o PIB. A regress√£o linear m√∫ltipla ser√° empregada para estimar os coeficientes que quantificam essas rela√ß√µes, permitindo-nos compreender melhor os determinantes do crescimento econ√¥mico.

Essa rela√ß√£o pode ser expressa pela seguinte equa√ß√£o:

Y=Œ≤0‚Äã+Œ≤1‚ÄãX1‚Äã+Œ≤2‚ÄãX2‚Äã+...+Œ≤p‚ÄãXp‚Äã+Œµ

Onde:

Y √© a vari√°vel dependente ( PIB Nacional (Y) em d√≥lares PPP de 2014).

X1‚Äã,X2‚Äã,...,Xp‚Äã s√£o as vari√°veis independentes ( For√ßa de Trabalho (L)e o Estoque de Capital (K) em d√≥lares PPP de 2014).


Œ≤1‚Äã,Œ≤2‚Äã,...,Œ≤p‚Äã s√£o os coeficientes de regress√£o que representam os efeitos das vari√°veis independentes na vari√°vel dependente.

Œµ √© o termo de erro, que representa a varia√ß√£o n√£o explicada pelo modelo.


Para garantir a robustez e confiabilidade dos resultados, optei por realizar uma transforma√ß√£o log-log nas vari√°veis, considerando que o PIB Nacional (Y) em d√≥lares PPP de 2014, juntamente com as vari√°veis independentes "for√ßa de trabalho" e "estoque de capital", n√£o apresentam uma distribui√ß√£o normal. Essa abordagem vai permitir que  aos pressupostos do modelo normal sejam atendidos e obter resultados mais consistentes.

Ao aplicar a transforma√ß√£o log-log, estamos ajustando a distribui√ß√£o das vari√°veis para se adequarem melhor ao modelo, mitigando quaisquer distor√ß√µes ou vi√©s que possam surgir devido √† falta de normalidade. Isso nos permite realizar infer√™ncias estat√≠sticas mais confi√°veis e interpretar os efeitos das vari√°veis independentes sobre o PIB Nacional de forma mais precisa.

Essa estrat√©gia de transforma√ß√£o aumenta a robustez da an√°lise, pois reduz a influ√™ncia de valores extremos e torna os resultados menos sens√≠veis a distribui√ß√µes n√£o normais. Portanto, podemos ter maior confian√ßa nas conclus√µes derivadas do modelo, garantindo uma abordagem metodol√≥gica s√≥lida e resultados mais confi√°veis para tomada de decis√£o.

## An√°lise Descritiva
```{r}

## criando as vari√°veis de interesse
# definindo as vari√°veis
dta$Y = dta$rgdpo
dta$L = dta$emp*dta$hc
dta$K = dta$rnna
# rearranjando colunas
dta = dta %>% relocate(Y, .after = year)
dta = dta %>% relocate(L, .after = Y)
dta = dta %>% relocate(K, .after = K)
# filtrando NAs
df.complete = dta[, c('Y', 'L', 'K')] %>% na.omit()
dta = merge(df.complete, dta, all.x = TRUE)


```


```{r}
#| label: tbl-t1
#| tbl-cap: Tabela Resumo das Vari√°veis Y, L e K.


descr_stats <- descr(dta[, c('Y', 'L', 'K')], 
                     stats = c("mean", "sd", "min", "med", "max"), 
                     transpose = FALSE, 
                     headings = FALSE)

# Convertendo para um dataframe para facilitar a manipula√ß√£o
descr_df <- as.data.frame(descr_stats)

# Adicionando a coluna de Estat√≠sticas
descr_df <- descr_df %>%
  select( everything())

# Exibindo a tabela formatada em markdown
library(knitr)
kable(descr_df, format = "markdown")

```


```{r}

#| label: grafico_Y
#| fig-cap: Histograma PIB Nacional (Y) em d√≥lares PPP de 2014
## histograma Y (usando base::plot)


hist_data = hist(dta$Y, xlab = 'Y', main = '', col = 'lightblue')
# dist. normal (p/ compara√ß√£o)
x_values = seq(min(dta$Y), max(dta$Y), length = 100)
y_values = dnorm(x_values, mean = mean(dta$Y), sd = sd(dta$Y)) 
y_values = y_values * diff(hist_data$mids[1:2]) * length(dta$Y) 
lines(x_values, y_values, lwd = 2)



```


Observando o  @grafico_Y  e @tbl-t1 , o valor m√≠nimo do PIB √© $2.569, enquanto o valor m√°ximo √© significativamente maior, chegando a $18.244.220, indicando uma grande varia√ß√£o no PIB entre os pa√≠ses da amostra.A m√©dia do PIB √© $769.941, o que √© substancialmente maior que a mediana de $123.419, sugerindo que alguns pa√≠ses com PIB muito alto est√£o puxando a m√©dia para cima. A distribui√ß√£o do PIB √© bastante assim√©trica, com muitos pa√≠ses tendo PIBs relativamente baixos e poucos pa√≠ses com PIBs muito altos.



```{r}

#| label: grafico-L
#| fig-cap: Histograma For√ßa de Trabalho (L)


## histograma L
# invocando ggplot
p = ggplot(dta, aes(x = L)) +
  # histograma
  geom_histogram(aes(x = L, after_stat(density)), fill = 'lightblue', col = 'black', bins = 10) +
  # dist. normal (p/ compara√ß√£o)
  stat_function(fun = dnorm,
                args = list(mean = mean(dta$L), sd = sd(dta$L))) + 
  # label eixo x
  xlab('L') +
  # label eixo y
  ylab('Density') +
  # tema do plot
  theme(
    # painel
    panel.background = element_blank(),
    panel.border = element_blank(),
    # eixos
    axis.line.x = element_line(linewidth = 0.5, linetype = "solid", colour = "black"),
    axis.line.y = element_line(linewidth = 0.5, linetype = "solid", colour = "black")
  )
p

```




Analisando o @grafico-L  e a @tbl-t1, a varia√ß√£o da for√ßa de trabalho de 0,2994 a 2.045,91 reflete uma grande disparidade na popula√ß√£o economicamente ativa entre os pa√≠ses. Com uma m√©dia de 54,60 e uma mediana de 11,65, a distribui√ß√£o mostra-se assim√©trica, sugerindo a presen√ßa de pa√≠ses com for√ßas de trabalho extremas, seja pela sua grandeza ou pequenez em rela√ß√£o √† m√©dia da amostrm alguns pa√≠ses com pa√≠ses com a for√ßa de trabalho outlier.


```{r}
#| fig-cap: Histograma Estoque de Capital (K) em d√≥lares PPP de 2014)
#| label: grafico-K


## histograma K
# invocando ggplot
p = ggplot(dta, aes(x = K)) +
  # histograma
  geom_histogram(aes(x = K, after_stat(density)), fill = 'lightblue', col = 'black', bins = 10) +
  # dist. normal (p/ compara√ß√£o)
  stat_function(fun = dnorm,
                args = list(mean = mean(dta$K), sd = sd(dta$K))) + 
  # label eixo x
  xlab('K') +
  # label eixo y
  ylab('Density') +
  # tema do plot
  theme(
    # painel
    panel.background = element_blank(),
    panel.border = element_blank(),
    # eixos
    axis.line.x = element_line(linewidth = 0.5, linetype = "solid", colour = "black"),
    axis.line.y = element_line(linewidth = 0.5, linetype = "solid", colour = "black")
  )
p

```


Analisando os valores da @tbl-t1 e @grafico-K, Observamos que o estoque de capital varia amplamente, de $7.345 a $64.118.472, indicando diferen√ßas significativas no n√≠vel de investimento em capital produtivo entre os pa√≠ses.

A m√©dia do estoque de capital √© $3.058.761, consideravelmente maior que a mediana de $394.841, o que sugere que alguns pa√≠ses t√™m estoques de capital extremamente altos que est√£o elevando a m√©dia.

## Regress√£o Normal
```{r}
#| label: tbl-t2
#| tbl-cap: Ajuste do Modelo de Regress√£o Normal com transforma√ß√£o

fit = lm(log(Y) ~ log(L) + log(K), data = dta)
# resultados
interpreta <- function(mod, alpha = 0.05) {
  tab <- summary(mod)
  tabela <- as.data.frame(coef(tab))
  tabela <- cbind(Covariavel = rownames(tabela), tabela)
  tabela <- tabela %>%
    mutate(
      Estima√ß√£o = Estimate,
      Pvalor = `Pr(>|t|)`,
      sig = case_when(
        is.na(`Pr(>|t|)`) ~ " ",
        `Pr(>|t|)` < 0.001 ~ "<0.001***",
         `Pr(>|t|)` <= alpha ~ paste0(" ", format(`Pr(>|t|)`, digits = 3), "*"),
        TRUE ~ paste0(" ", format(`Pr(>|t|)`, digits = 3))
      )
    ) %>%
    select( Estima√ß√£o, Pvalor, sig)
  
  return(tabela)
}



  

fit %>% interpreta()                           
```


Todos os valores-p associados aos coeficientes s√£o muito pequenos (<0.001), o que significa que podemos rejeitar a hip√≥tese nula para todos os coeficientes, ao n√≠vel de 5% de confian√ßa. Isso indica que tanto a for√ßa de trabalho quanto o estoque de capital t√™m efeitos significativos no PIB, conforme medido pelo logaritmo.


O coeficiente estimado para log(K) √© 0,70728. Isso significa que, se o estoque de capital (ùêæ) aumentar em 1%, o PIB (ùëå) aumentar√° em aproximadamente 0.70728 √ó 100 = 70.728 , mantendo todas as outras vari√°veis constantes.


O coeficiente estimado para log ‚Å° ( ùêø )  √© ,.29. Isso significa que, se a for√ßa de trabalho ( L) aumentar em 1%, o PIB (ùëå) aumentar√° em aproximadamente 0,29 √ó 100 =29,409, mantendo todas as outras vari√°veis constantes.

Al√©m disso, o modelo tem um R-quadrado ajustado de aproximadamente 0,96, o que significa que aproximadamente 95,92% da variabilidade no logaritmo do PIB pode ser explicada pelas vari√°veis independentes inclu√≠das no modelo.

Esses resultados sugerem que tanto a for√ßa de trabalho quanto o estoque de capital t√™m um impacto significativo no PIB, conforme medido pelo logaritmo.

## Ap√™ndice 

```{r}
#| label: tbl-t3
#| fig-cap: Grafico de An√°lise de res√≠duos 

ggresiduals(fit)
#testResiduals(fit)
```



Com base na an√°lise da tabela @tbl-t3, podemos concluir o seguinte sobre o ajuste do modelo de regress√£o:

**Homocedasticidade:**
   - A vari√¢ncia dos res√≠duos parece ser constante em toda a faixa dos valores ajustados, o que √© consistente com a suposi√ß√£o de homocedasticidade na regress√£o linear.

**Normalidade:**
   - Embora o teste de Shapiro-Wilk sugira que os res√≠duos n√£o sigam uma distribui√ß√£o normal, desconsiderando caudas pesadas tanto nos extremos inferiores quanto nos superiores, podemos aproximar que os res√≠duos est√£o pr√≥ximos de uma distribui√ß√£o normal.

**Independ√™ncia dos Res√≠duos:**
   - Tanto o teste de Durbin-Watson quanto a inspe√ß√£o do gr√°fico de res√≠duos versus valores ajustados na tabela @tbl-t3 n√£o fornecem evid√™ncias significativas para rejeitar a hip√≥tese nula de aus√™ncia de autocorrela√ß√£o positiva ou negativa nos res√≠duos. Assim, parece que os res√≠duos s√£o independentes entre si.

**Linearidade:**
   - N√£o h√° um padr√£o claro nos res√≠duos plotados em rela√ß√£o aos valores ajustados, indicando linearidade entre as vari√°veis independentes e dependentes.

Em resumo, o modelo de regress√£o parece atender √†s suposi√ß√µes de homocedasticidade, normalidade aproximada dos res√≠duos, independ√™ncia dos res√≠duos e linearidade entre as vari√°veis.





